/****************************** File *********************************Module: dim3 EditorAuthor: Brian Barnes Usage: Portal View Drawing Routines***************************** License ********************************This code can be freely used as long as these conditions are met:1. This header, in its entirety, is kept with the code2. This credit ÒCreated with dim3 TechnologyÓ is given on a singleapplication screen and in a single piece of the documentation3. It is not resold, in it's current form or modified, as anengine-only productThis code is presented as is. The author of dim3 takes noresponsibilities for any version of this code.Any non-engine product (games, etc) created with this code is freefrom any and all payment and/or royalties to the author of dim3,and can be sold or given away.(c) 2000-2007 Klink! Software www.klinksoftware.com *********************************************************************/#include "portal_view.h"extern map_type				map;extern int					cx,cz;extern float				walk_view_y_angle;extern Rect					portal_view_box;/* =======================================================      Portal Sizes      ======================================================= */void portal_view_get_portal(int rn,int *x,int *z,int *ex,int *ez){	portal_type		*portal;		portal=&map.portals[rn];		*x=portal->x;	*z=portal->z;	portal_view_map_to_pane(x,z);		*ex=portal->ex;	*ez=portal->ez;	portal_view_map_to_pane(ex,ez);}/* =======================================================      Draw Portal View Walls      ======================================================= */void portal_view_draw_portal_walls(int rn){	register int				i,x,z;	int							lx,rx,lz,rz;	register segment_type		*seg;	register wall_segment_data  *wall;	RGBColor					blackcolor={0x0,0x0,0x0},bluecolor={0x0,0x0,0xFFFF};			// room x,z			x=map.portals[rn].x;	z=map.portals[rn].z;			// draw walls		RGBForeColor(&bluecolor);		seg=map.segments;			for (i=0;i!=map.nsegment;i++) {			if ((seg->type==sg_wall) && (seg->rn==rn)) {					wall=&seg->data.wall;						lx=wall->lx+x;			lz=wall->lz+z;			portal_view_map_to_pane(&lx,&lz);			rx=wall->rx+x;			rz=wall->rz+z;			portal_view_map_to_pane(&rx,&rz);						MoveTo(lx,lz);				LineTo(rx,rz);		}				seg++;	}		RGBForeColor(&blackcolor);}